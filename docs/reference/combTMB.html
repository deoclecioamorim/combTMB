<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fit Hierarchical models with normal and conjugate random effects with the TMB
(Template Model Builder) R package. This can be to model hierarchical data
subject to within-unit correlation and/or overdispersion."><title>Fit Combined Models with TMB — combTMB • combTMB</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit Combined Models with TMB — combTMB"><meta property="og:description" content="Fit Hierarchical models with normal and conjugate random effects with the TMB
(Template Model Builder) R package. This can be to model hierarchical data
subject to within-unit correlation and/or overdispersion."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">combTMB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fit Combined Models with TMB</h1>
      
      <div class="d-none name"><code>combTMB.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit Hierarchical models with normal and conjugate random effects with the TMB
(Template Model Builder) R package. This can be to model hierarchical data
subject to within-unit correlation and/or overdispersion.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">combTMB</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span>,</span>
<span>  dformula <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>  REML <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  doMarginal <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  offset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">na.action</span>,</span>
<span>  starting_val <span class="op">=</span> <span class="st">"zero"</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="combTMBcontrol.html">combTMBcontrol</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  map <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dofit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>combined fixed and random effects formula, following <span class="pkg">lme4</span> syntax.
IID random intercepts are possible using e.g., `+ (1 | Subject)` where `Subject`
is a factor representing groups.</p></dd>


<dt>data</dt>
<dd><p>an optional data frame containing the variables in the model.
If missing data, the variables ara taken from <code>environment(formula)</code>.
Not required, but strongly recommended. If not specified, a warning message will
be issued.</p></dd>


<dt>family</dt>
<dd><p>a family function, a character string naming a family function.
Options are [gaussian()], [binomial()], [poisson()], <code>Beta()</code>,
<code><a href="families.html">betabinomial()</a></code>,
<code><a href="families.html">poigamma()</a></code>, <code>bb()</code> and
<code>bb_al()</code>. For binomial family options, see 'Binomial families' in the Details
 section below. For more details see <code><a href="families.html">family_combTMB</a></code>.</p></dd>


<dt>dformula</dt>
<dd><p>an object of class "<code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code>" describe
the model for dispersion containing only fixed effects: the default ~1:
specifies the standard dispersion any family, however the argument is ignored
for families that do not have a dispersion parameter, for example [binomial()] family.
One can declare a linear predictor for the dispersion, internally a log link is applied.</p></dd>


<dt>REML</dt>
<dd><p>logical: use REML (restricted maximum likelihood) estimation
rather than maximum likelihood. Internally, this adds the fixed effects to
the list of random effects to integrate over.</p></dd>


<dt>doMarginal</dt>
<dd><p>marginalization of regression parameters is only available
for a random effect for the following families: [binomial()], [poisson()] and
<code><a href="families.html">poigamma()</a></code>. The default NULL. The argument is ignored for
the other families.</p></dd>


<dt>weights</dt>
<dd><p>an optional vector representing likelihood weights for the
conditional model. Weights are not modified internally and do not scale
to sum 1. The default is NULL. Can also be used for testing with
the binomial family - see <code>Details</code>. The `weights` argument needs to be a vector and not
  a name of the variable in the data frame</p></dd>


<dt>offset</dt>
<dd><p>a numeric vector representing the model offset. The `offset` argument needs to be a vector and not
a name of the variable in the data frame. *Not included in any prediction.*</p></dd>


<dt>contrasts</dt>
<dd><p>an optional list. See the <code>contrasts.arg</code> of
<code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix.default</a></code>.</p></dd>


<dt>na.action</dt>
<dd><p>a function that specifies how to handle observations
containing <code>NA</code>s. The default action (<code>na.omit</code>,
inherited from the 'factory fresh' value of
<code>getOption("na.action")</code>) strips any observations with any
missing values in any variables. Using <code>na.action = na.exclude</code>.</p></dd>


<dt>starting_val</dt>
<dd><p>an character indicating which method should be used to
provide initial values. Options are the estimated values through a fitted
model using <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm.fit</a></code> <code>"fm"</code> and all initial parameter values
are zero <code>"zero"</code>.</p></dd>


<dt>control</dt>
<dd><p>optimization control options via <code><a href="combTMBcontrol.html">combTMBcontrol</a></code>.</p></dd>


<dt>map</dt>
<dd><p>a named list where the user can set a parameter to a constant value
instead of estimating it. A fixed value is the one established as the initial
guess in the optimization process. To understand the use of the map argument
consider the example, map=list(beta=factor(c(1,NA))), the first fixed effect
parameter is modeled while the second parameter is kept at its initial value.
See [TMB::MakeADFun()] for more details.</p></dd>


<dt>size</dt>
<dd><p>number of trials in binomial model.</p></dd>


<dt>dofit</dt>
<dd><p>fit the model (`TRUE`) or return the processed data without fitting (`FALSE`)?</p></dd>


<dt>silent</dt>
<dd><p>silent or include optimization details? Helpful to set to
`FALSE` for models that take a while to fit.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object (list) of class `combTMB`. With a number of useful elements among them:</p>


<ul><li><p><code>tmb_obj</code>: The TMB object created by [TMB::MakeADFun()]</p></li>
<li><p><code>tmb_report</code>: output from [TMB::sdreport()]</p></li>
<li><p><code>Gradients</code>: log likelihood gradients with respect to each fixed effect</p></li>
<li><p><code>fit</code>: output from [stats::nlminb()] or [stats::optim()]</p></li>
<li><p><code>data</code>: the fitted data</p></li>
<li><p><code>tmb_params</code>: The parameters list passed to [TMB::MakeADFun()]</p></li>
<li><p><code>...</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>Binomial families</code></p>
<p>For a binomial family, the response variable can be in four ways:</p><ul><li><p><code>(i)</code> the response can be a factor (and the model ranks the first level versus all others);</p></li>
<li><p><code>(ii)</code> the response can be binary (0/1);</p></li>
<li><p><code>(iii)</code> the response can be an array of the form `cbind(success, failure)`; and</p></li>
<li><p><code>(iv)</code> the response can be in proportions, and the 'weights' argument is used to specify the binomial size(N) parameter (`prop ~ ..., weights = N`).</p></li>
</ul><p><code>Marginalization</code></p>
<p>The option of marginalizing the regression parameters is currently only
available for the [binomial()], [poisson()] and
<code><a href="families.html">poigamma()</a></code> only one random effect.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Molenberghs, G., Verbeke, G., and Demetrio, C. G. (2007). An extended
random-effects approach to modeling repeated, overdispersed count data.
<em>Lifetime data analysis</em>, 13(4), 513-531.</p></li>
<li><p>Molenberghs, G., Verbeke, G., Demetrio, C. G., and Vieira, A. M. (2010).
A family of generalized linear models for repeated measures with normal
and conjugate random effects. <em>Statistical science</em>, 25(3), 325-347.</p></li>
<li><p>Molenberghs, G., Verbeke, G., Iddi, S., and Demetrio, C. G. (2012).
A combined beta and normal random-effects model for repeated,
overdispersed binary and binomial data.
<em>Journal of Multivariate Analysis</em>, 111, 94-109.</p></li>
<li><p>Iddi, S. and Molenberghs, G. (2012). A combined overdispersed and marginalized
multilevel model. <em>Computational Statistics &amp; Data Analysis</em>, 56(6), 1944-1951.</p></li>
<li><p>Molenberghs, G., Verbeke, G., and Demetrio, C. G. (2017). Hierarchical models
with normal and conjugate random effects: a review. <em>Statistics and Operations
Research Transactions</em>, 41(2), 191-253.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">combTMB</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Poisson-Normal model</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">combTMB</span><span class="op">(</span><span class="va">OT</span> <span class="op">~</span> <span class="va">Period</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Donor</span><span class="op">)</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>, data<span class="op">=</span><span class="va">embryos</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: poisson </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: log </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: OT ~ Period + (1 | Donor) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of obs: 1148 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2 x logLik         AIC         BIC    df.resid </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      7839.5      7845.5      7860.7        1145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  2.69168    0.03307  81.397  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PeriodP2     0.06419    0.01859   3.454 0.000553 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Donor (Intercept)    0.268      0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of subjects: 318 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Using 'map' to fix parameter</span></span></span>
<span class="r-in"><span><span class="va">m1_map</span> <span class="op">&lt;-</span> <span class="fu">combTMB</span><span class="op">(</span><span class="va">OT</span> <span class="op">~</span> <span class="va">Period</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Donor</span><span class="op">)</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>, map<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  data<span class="op">=</span><span class="va">embryos</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1_map</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: poisson </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: log </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: OT ~ Period + (1 | Donor) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of obs: 1148 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2 x logLik         AIC         BIC    df.resid </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      7851.5      7855.5      7865.6        1146 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  2.73290    0.03099   88.18   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PeriodP2     0.00000         NA      NA       NA    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Donor (Intercept)   0.2715      0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of subjects: 318 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Combined model: Poisson-Gamma-Normal model</span></span></span>
<span class="r-in"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">combTMB</span><span class="op">(</span><span class="va">OT</span> <span class="op">~</span> <span class="va">Period</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Donor</span><span class="op">)</span>, family<span class="op">=</span><span class="fu"><a href="families.html">poigamma</a></span><span class="op">(</span><span class="op">)</span>, data<span class="op">=</span><span class="va">embryos</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: poigamma </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: log </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: OT ~ Period + (1 | Donor) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dformula: ~1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of obs: 1148 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2 x logLik         AIC         BIC    df.resid </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      7650.5      7658.5      7678.7        1144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  2.69904    0.03475  77.662  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PeriodP2     0.06813    0.02520   2.704  0.00686 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Donor (Intercept)   0.2484      0.024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overdisp.(theta)   21.9242      2.498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of subjects: 318 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Combined overdispersed and marginalized multilevel models (COMMM)</span></span></span>
<span class="r-in"><span><span class="va">m2_COMMM</span> <span class="op">&lt;-</span> <span class="fu">combTMB</span><span class="op">(</span><span class="va">OT</span> <span class="op">~</span> <span class="va">Period</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Donor</span><span class="op">)</span>, family<span class="op">=</span><span class="fu"><a href="families.html">poigamma</a></span><span class="op">(</span><span class="op">)</span>, doMarginal<span class="op">=</span><span class="cn">TRUE</span>,data<span class="op">=</span><span class="va">embryos</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2_COMMM</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: poigamma </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: log </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: OT ~ Period + (1 | Donor) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dformula: ~1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of obs: 1148 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2 x logLik         AIC         BIC    df.resid </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      7650.5      7658.5      7678.7        1144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  2.82325    0.03628  77.828  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PeriodP2     0.06813    0.02520   2.704  0.00686 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Donor (Intercept)   0.2484      0.024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overdisp.(theta)   21.9243      2.498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of subjects: 318 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Logistic-Normal model</span></span></span>
<span class="r-in"><span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu">combTMB</span><span class="op">(</span><span class="va">onyresp</span><span class="op">~</span><span class="va">treatn</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="va">treatn</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="va">time</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">idnum</span><span class="op">)</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">toenail</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: binomial </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: logit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: onyresp ~ treatn - 1 + treatn %in% time + (1 | idnum) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of obs: 1908 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2 x logLik         AIC         BIC    df.resid </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1252.6      1262.6      1290.4        1903 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatn0      -2.56253    0.81191  -3.156  0.00160 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatn1      -2.82287    0.86546  -3.262  0.00111 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatn0:time -0.41415    0.04890  -8.470  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatn1:time -0.57672    0.06419  -8.984  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> idnum (Intercept)    21.21      6.853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of subjects: 294 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Combined model: Beta-Bernoulli-Normal model</span></span></span>
<span class="r-in"><span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu">combTMB</span><span class="op">(</span><span class="va">onyresp</span><span class="op">~</span><span class="va">treatn</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="va">treatn</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="va">time</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">idnum</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      family <span class="op">=</span> <span class="fu"><a href="families.html">betabernoulli</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"probit"</span><span class="op">)</span>,data <span class="op">=</span> <span class="va">toenail</span>,</span></span>
<span class="r-in"><span>       control <span class="op">=</span> <span class="fu"><a href="combTMBcontrol.html">combTMBcontrol</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"nlminb"</span>,newtonLoops <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                              lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>betad<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>,upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>betad<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The model may not have converged. Maximum final gradient: 4.46069636421333.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: betabernoulli </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: probit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: onyresp ~ treatn - 1 + treatn %in% time + (1 | idnum) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dformula: ~1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of obs: 1908 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2 x logLik         AIC         BIC    df.resid </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1140.7      1152.7      1186.1        1902 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatn0       -4.5585     0.2954 -15.430  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatn1       -4.6130     0.3083 -14.961  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatn0:time  -1.7995     0.1513 -11.896  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> treatn1:time  -2.1381     0.3251  -6.577  4.8e-11 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> idnum (Intercept) 453.8969    119.170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overdisp.(theta)    0.2148      0.026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of subjects: 294 </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Deoclecio Jardim Amorim, Afranio Marcio Correa Vieira, Clarice Garcia Borges Demetrio.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

